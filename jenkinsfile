pipeline{
	agent any 
	environment{
		Dockerhub_Credentials=credentials('dockerhub')
		//Dockerhub_Credentials=credentials('Docker')
		}
	stages{
		stage('git checkout'){
			steps{
				checkout scmGit (branches: [[name: '*/11-cicd-for-react-front-via-jenkins']],userRemoteConfigs: [[credentialsId: 'Github_Id', url: 'https://github.com/swetank01/open-microapp.git']])
			}
		}
		stage('docker build'){
			steps{
				//dir('docker/frontend.Dockerfile')
				script{
					//def dockerfilePath='docker/frontend.Dockerfile'
					def dockerimage='sewani/frontend_microapp'
					//docker build(${dockerimage}:${env.BUILD_NUMBER}, '-f ' + dockerfilePath)"
					//docker build -t dockerimage, '-f ' + dockerfilePath .
					//docker build  -t ${dockerimage} '-f ' + docker/frontend.Dockerfile .
					//docker.build -f docker/frontend.Dockerfile -t dockerimage .
					//sh "docker build -t ${dockerimage}:${env.BUILD_NUMBER}, '-f docker/frontend.Dockerfile' ."
					sh "docker build -t ${dockerimage}:${env.BUILD_NUMBER} -f docker/frontend.Dockerfile ."

					}
				}
				
			
		}
		stage('docker login'){
			steps{
				script{
					sh 'echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
					}
				}
			}
	}
}
