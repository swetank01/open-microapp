pipeline{
	agent any 
	environment{
		Dockerhub_Credentials=credentials('dockerhub')
		}
	stages{
		stage('git checkout'){
			steps{
				checkout scmGit (branches: [[name: '*/11-cicd-for-react-front-via-jenkins']],userRemoteConfigs: [[credentialsId: 'Github_id', url: 'https://github.com/swetank01/open-microapp.git']])
			}
		}
		stage('docker build'){
			steps{
				dir('docker/frontend.Dockerfile'){
					script{
						def dockerimage='sewani/frontend_microapp'
						sh "docker build -t ${dockerimage}:${env.BUILD_NUMBER} ."
					}
				}
				
			}
		}
		stage('docker login'){
			steps{
				script{
					sh 'echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
					}
				}
			}
	}
}
